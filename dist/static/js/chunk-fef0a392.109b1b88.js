(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fef0a392"],{9041:function(t,e,n){"use strict";var r=n("ee11"),o=n.n(r);o.a},c04c:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[t.step?n("el-steps",{staticStyle:{"margin-bottom":"30px"},attrs:{active:2,"align-center":""}},[n("el-step",{attrs:{title:"已完成"}}),t._v(" "),n("el-step",{attrs:{title:"选择订单使用模板"}})],1):t._e(),t._v(" "),n("el-collapse",[n("el-collapse-item",{attrs:{title:"订单信息",name:"1"}},[n("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},[n("el-form-item",{attrs:{label:"淘宝订单号",prop:"oid"}},[n("span",[t._v(t._s(t.order.oid))])]),t._v(" "),n("el-form-item",{attrs:{label:"收件人信息",prop:"recipient_information"}},[n("span",[t._v(t._s(t.order.recipient_information))])]),t._v(" "),n("el-form-item",{attrs:{label:"规格型号",prop:"sofa_cover_id"}},[n("span",[t._v(t._s(t.order.sofa.name))])]),t._v(" "),n("el-form-item",{attrs:{label:"材料选择",prop:"sofa_cover_item_id"}},[n("span",[t._v(t._s(t.order.sofa_item.chain_name))])]),t._v(" "),n("el-form-item",{attrs:{label:"备注",prop:"note"}},[n("span",[t._v(t._s(t.order.note))])])],1)],1)],1),t._v(" "),n("h5",[t._v("定制规格")]),t._v(" "),n("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeIndex,callback:function(e){t.activeIndex=e},expression:"activeIndex"}},t._l(t.designs,(function(e,r){return n("el-tab-pane",{attrs:{label:e.name,design:e,name:"index"+r}},[n("el-form",{ref:"form",refInFor:!0,attrs:{model:t.form,rule:t.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"规格名称"}},[n("span",[t._v(t._s(e.name))])]),t._v(" "),n("el-form-item",{attrs:{label:"示意图"}},[n("el-image",{staticStyle:{width:"500px",height:"500px"},attrs:{src:e.url,fit:"fill"}})],1),t._v(" "),t._l(e.types,(function(e){return n("el-form-item",{attrs:{label:e}},[t.order.confirmed_at?n("span",[t._v(t._s(t.form.lengths[e]))]):n("el-input",{attrs:{placeholder:"单位：cm"},model:{value:t.form.lengths[e],callback:function(n){t.$set(t.form.lengths,e,n)},expression:"form.lengths[type]"}})],1)})),t._v(" "),n("el-form-item",{attrs:{label:"个数"}},[t.order.confirmed_at?n("span",[t._v(t._s(t.form.count))]):n("el-input",{ref:t.form.count,refInFor:!0,model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"耗材(cm)"}},[n("span",[t._v(t._s(""+t.form.width*t.form.count))])]),t._v(" "),n("el-form-item",{attrs:{label:"辅料"}},[n("span",[t._v(t._s(""+t.form.design.accessories))])]),t._v(" "),n("el-form-item",{attrs:{label:"辅料个数"}},[n("span",[t._v(t._s(""+t.form.design.accessories_count*t.form.count))])]),t._v(" "),n("el-form-item",[t.order.confirmed_at?t._e():n("el-button",{attrs:{loading:t.loading,type:"primary"},nativeOn:{click:function(e){return t.onSubmit(e)}}},[t._v("保存")]),t._v(" "),!t.order.confirmed_at&&t.form.width?n("el-button",{attrs:{loading:t.loading,type:"danger"},nativeOn:{click:function(e){return t.onDel(e)}}},[t._v("删除")]):t._e()],1)],2)],1)})),1),t._v(" "),t.order.confirmed_at?n("el-button",{attrs:{type:"primary"}},[n("a",{attrs:{target:"_blank",href:t.order.print}},[t._v("打印")])]):t._e()],1)},o=[],i=n("f8b7"),s={data:function(){return{form:{lengths:{},count:"",width:"",design:{accessories:"",accessories_count:0}},order:{oid:"",recipient_information:"",sofa:{},sofa_item:{},note:"",ods:{},print:""},designs:[{id:0}],activeDesign:{},rules:{lengths:[{required:!0,trigger:"blur",message:"边长必填"}],count:[{required:!0,trigger:"blur",message:"个数必填"}]},loading:!1,activeIndex:"index0"}},computed:{id:function(){return this.$route.params.id},step:function(){return this.$route.query.step}},mounted:function(){var t=this;Object(i["e"])(this.id).then((function(e){var n=e.data;t.order=n,t.designs=n.sofa.designs,t.activeDesign=n.sofa.designs[0],t.freshDesign()}))},methods:{handleClick:function(t,e){this.activeDesign=t.$attrs.design,this.freshDesign()},freshDesign:function(){var t=this;Object(i["f"])(this.id,this.activeDesign.id).then((function(e){var n=e.data;t.form.lengths=n.lengths||{},t.form.count=n.count||"",t.form.width=n.width||"",t.form.design.accessories=n.design?n.design.accessories:"",t.form.design.accessories_count=n.design?n.design.accessories_count:""}))},onSubmit:function(){for(var t=this,e=0;e<this.activeDesign.types.length;e++){var n=this.activeDesign.types[e];if(!this.form.lengths[n])return this.$message.error("".concat(n,"必须填写"))}if(!(this.form.count>=0))return this.$message.error("个数必须填写");this.loading=!0,Object(i["i"])(this.id,this.activeDesign.id,this.form).then((function(e){t.$message("保存成功"),t.loading=!1;var n=e.data;t.form.lengths=n.lengths||{},t.form.count=n.count||"",t.form.width=n.width||""})).catch((function(e){console.log(e),t.loading=!1}))},onDel:function(){var t=this;this.loading=!0,Object(i["d"])(this.id,this.activeDesign.id).then((function(e){t.loading=!1,t.form={lengths:{},count:"",width:"",design:{accessories:"",accessories_count:0}}})).catch((function(e){console.log(e),t.loading=!1}))}}},a=s,c=(n("9041"),n("2877")),l=Object(c["a"])(a,r,o,!1,null,"6572395a",null);e["default"]=l.exports},ee11:function(t,e,n){},f8b7:function(t,e,n){"use strict";n.d(e,"g",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"h",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return u})),n.d(e,"d",(function(){return f}));var r=n("b775");function o(t){return Object(r["a"])({url:"order?".concat(t),method:"get"})}function i(t){return Object(r["a"])({url:"order/".concat(t),method:"get"})}function s(t){return Object(r["a"])({url:"order",method:"post",data:t})}function a(t,e){return Object(r["a"])({url:"order/".concat(t,"/update"),method:"post",data:e})}function c(t){return Object(r["a"])({url:"order/".concat(t,"/delete"),method:"post"})}function l(t){return Object(r["a"])({url:"order/".concat(t,"/confirm"),method:"post"})}function d(t,e){return Object(r["a"])({url:"order/".concat(t,"/design/").concat(e),method:"get"})}function u(t,e,n){return Object(r["a"])({url:"order/".concat(t,"/design/").concat(e,"/update"),method:"post",data:n})}function f(t,e){return Object(r["a"])({url:"order/".concat(t,"/design/").concat(e,"/delete"),method:"post"})}}}]);