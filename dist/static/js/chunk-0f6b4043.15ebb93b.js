(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f6b4043"],{"03f6":function(e,t,r){"use strict";var n=r("8d87"),o=r.n(n);o.a},"8d87":function(e,t,r){},c04c:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[e.step?r("el-steps",{staticStyle:{"margin-bottom":"30px"},attrs:{active:2,"align-center":""}},[r("el-step",{attrs:{title:"已完成"}}),e._v(" "),r("el-step",{attrs:{title:"选择定制规格"}})],1):e._e(),e._v(" "),r("div",[r("h5",[e._v("订单信息")]),e._v(" "),r("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},[r("el-form-item",{attrs:{label:"淘宝订单号",prop:"oid"}},[r("span",[e._v(e._s(e.order.oid))])]),e._v(" "),r("el-form-item",{attrs:{label:"收件人信息",prop:"recipient_information"}},[r("span",[e._v(e._s(e.order.recipient_information))])]),e._v(" "),r("el-form-item",{attrs:{label:"定制类型",prop:"sofa_cover_id"}},[r("span",[e._v(e._s(e.order.sofa.name))])]),e._v(" "),r("el-form-item",{attrs:{label:"材料选择",prop:"sofa_cover_item_id"}},[r("span",[e._v(e._s(e.order.sofa_item.chain_name))])]),e._v(" "),r("el-form-item",{attrs:{label:"订单总额",prop:"sofa_cover_item_id"}},[r("span",[e._v(e._s(e.order.total))])]),e._v(" "),r("el-form-item",{attrs:{label:"数量",prop:"sofa_cover_item_id"}},[r("span",[e._v(e._s(e.order.count))])]),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"note"}},[r("span",[e._v(e._s(e.order.note))])])],1),e._v(" "),r("h5",[e._v("已定制规格列表")]),e._v(" "),r("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},e._l(e.ods,(function(t){return r("el-form-item",{attrs:{label:t.name}},[r("span",[e._v(e._s(t.info))])])})),1)],1),e._v(" "),r("h5",[e._v("定制规格")]),e._v(" "),r("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},e._l(e.designs,(function(t,n){return r("el-tab-pane",{attrs:{label:t.name,design:t,name:"index"+n}},[r("el-form",{ref:"form",refInFor:!0,attrs:{model:e.form,rule:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"规格名称"}},[r("span",[e._v(e._s(t.name))])]),e._v(" "),r("el-form-item",{attrs:{label:"示意图"}},[r("el-image",{staticStyle:{width:"500px",height:"500px"},attrs:{src:t.url,fit:"fill"}})],1),e._v(" "),r("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":e.odTabChange},model:{value:e.odIndex,callback:function(t){e.odIndex=t},expression:"odIndex"}},[e._l(e.orderDesigns,(function(e,t){return r("el-tab-pane",{attrs:{label:"方案"+(t+1),od:e,i:t,name:"plan"+e.id}})})),e._v(" "),r("el-tab-pane",{attrs:{label:"新增",name:"add"}})],2),e._v(" "),e._l(t.types,(function(t){return r("el-form-item",{attrs:{label:t}},[e.order.confirmed_at?r("span",[e._v(e._s(e.form.lengths[t]))]):r("el-input",{attrs:{placeholder:"单位：cm"},model:{value:e.form.lengths[t],callback:function(r){e.$set(e.form.lengths,t,r)},expression:"form.lengths[type]"}})],1)})),e._v(" "),r("el-form-item",{attrs:{label:"个数"}},[e.order.confirmed_at?r("span",[e._v(e._s(e.form.count))]):r("el-input",{ref:e.form.count,refInFor:!0,model:{value:e.form.count,callback:function(t){e.$set(e.form,"count",t)},expression:"form.count"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"耗用布料"}},[r("span",[e._v(e._s(""+e.form.width*e.form.count))])]),e._v(" "),r("el-form-item",{attrs:{label:"辅料"}},[r("span",[e._v(e._s(""+e.form.design.accessories))])]),e._v(" "),r("el-form-item",{attrs:{label:"辅料个数"}},[r("span",[e._v(e._s(""+e.form.design.accessories_count*e.form.count))])]),e._v(" "),r("el-form-item",[e.order.confirmed_at?e._e():r("el-button",{attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return e.onSubmit(t)}}},[e._v("保存")]),e._v(" "),!e.order.confirmed_at&&e.form.od_id?r("el-button",{attrs:{loading:e.loading,type:"danger"},nativeOn:{click:function(t){return e.onDel(t)}}},[e._v("删除")]):e._e()],1)],2)],1)})),1),e._v(" "),e.order.confirmed_at?r("el-button",{attrs:{type:"primary"}},[r("a",{attrs:{target:"_blank",href:e.order.print}},[e._v("打印")])]):e._e()],1)},o=[],i=(r("7f7f"),r("f8b7")),s={data:function(){return{form:{od_id:"",lengths:{},count:"",width:"",design:{accessories:"",accessories_count:0}},order:{oid:"",recipient_information:"",sofa:{},sofa_item:{},note:"",ods:{},print:""},designs:[{id:0}],activeDesign:{},rules:{lengths:[{required:!0,trigger:"blur",message:"边长必填"}],count:[{required:!0,trigger:"blur",message:"个数必填"}]},loading:!1,activeIndex:"index0",ods:[],orderDesigns:[],odIndex:"add"}},computed:{id:function(){return this.$route.params.id},step:function(){return this.$route.query.step}},mounted:function(){this.freshOrder()},methods:{freshOrder:function(){var e=this;Object(i["e"])(this.id).then((function(t){var r=t.data;e.order=r,e.designs=r.sofa.designs,e.activeDesign||(e.activeDesign=r.sofa.designs[0]),e.freshDesign()}))},handleClick:function(e,t){this.activeDesign=e.$attrs.design,this.freshDesign()},freshDesign:function(){var e=this;Object(i["f"])(this.id,this.activeDesign.id).then((function(t){var r=t.data;e.orderDesigns=r.data,e.ods=r.meta.ods,e.clearForm()}))},onSubmit:function(){for(var e=this,t=0;t<this.activeDesign.types.length;t++){var r=this.activeDesign.types[t];if(!this.form.lengths[r])return this.$message.error("".concat(r,"必须填写"))}if(!(this.form.count>=0))return this.$message.error("个数必须填写");this.loading=!0,Object(i["i"])(this.id,this.activeDesign.id,this.form).then((function(t){e.$message("保存成功"),e.loading=!1,e.freshOrder()})).catch((function(t){console.log(t),e.loading=!1}))},onDel:function(){var e=this;this.loading=!0,Object(i["d"])(this.id,this.activeDesign.id,this.form.od_id).then((function(t){e.loading=!1,e.ods=t.data,e.freshOrder()})).catch((function(t){console.log(t),e.loading=!1}))},odTabChange:function(e){var t=e.$attrs.i;if("add"===e.name)return this.clearForm(),!1;this.form.od_id=e.$attrs.od.id,this.form.lengths=this.orderDesigns[t].lengths,this.form.count=this.orderDesigns[t].count,this.form.width=this.orderDesigns[t].width,this.form.design.accessories=this.orderDesigns[t].design?this.orderDesigns[t].design.accessories:"",this.form.design.accessories_count=this.orderDesigns[t].design?this.orderDesigns[t].design.accessories_count:""},clearForm:function(){this.form.od_id="",this.form.lengths={},this.form.count="",this.form.width="",this.form.design.accessories="",this.form.design.accessories_count="",this.odIndex="add"}}},a=s,c=(r("03f6"),r("2877")),d=Object(c["a"])(a,n,o,!1,null,"1411e01e",null);t["default"]=d.exports},f8b7:function(e,t,r){"use strict";r.d(t,"g",(function(){return o})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"h",(function(){return a})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"f",(function(){return l})),r.d(t,"i",(function(){return f})),r.d(t,"d",(function(){return u}));var n=r("b775");function o(e){return Object(n["a"])({url:"order?".concat(e),method:"get"})}function i(e){return Object(n["a"])({url:"order/".concat(e),method:"get"})}function s(e){return Object(n["a"])({url:"order",method:"post",data:e})}function a(e,t){return Object(n["a"])({url:"order/".concat(e,"/update"),method:"post",data:t})}function c(e){return Object(n["a"])({url:"order/".concat(e,"/delete"),method:"post"})}function d(e){return Object(n["a"])({url:"order/".concat(e,"/confirm"),method:"post"})}function l(e,t){return Object(n["a"])({url:"order/".concat(e,"/design/").concat(t),method:"get"})}function f(e,t,r){return Object(n["a"])({url:"order/".concat(e,"/design/").concat(t,"/update"),method:"post",data:r})}function u(e,t,r){return Object(n["a"])({url:"order/".concat(e,"/design/").concat(t,"/od/").concat(r,"/delete"),method:"post"})}}}]);