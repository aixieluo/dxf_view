(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58f06d4b"],{"0f83":function(t,e,r){"use strict";var n=r("7a29"),o=r.n(n);o.a},"7a29":function(t,e,r){},c04c:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[t.step?r("el-steps",{staticStyle:{"margin-bottom":"30px"},attrs:{active:2,"align-center":""}},[r("el-step",{attrs:{title:"已完成"}}),t._v(" "),r("el-step",{attrs:{title:"选择定制规格"}})],1):t._e(),t._v(" "),r("div",[r("h5",[t._v("订单信息")]),t._v(" "),r("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},[r("el-form-item",{attrs:{label:"淘宝订单号",prop:"oid"}},[r("span",[t._v(t._s(t.order.oid))])]),t._v(" "),r("el-form-item",{attrs:{label:"收件人信息",prop:"recipient_information"}},[r("span",[t._v(t._s(t.order.recipient_information))])]),t._v(" "),r("el-form-item",{attrs:{label:"定制类型",prop:"sofa_cover_id"}},[r("span",[t._v(t._s(t.order.sofa.name))])]),t._v(" "),r("el-form-item",{attrs:{label:"材料选择",prop:"sofa_cover_item_id"}},[r("span",[t._v(t._s(t.order.sofa_item.chain_name))])]),t._v(" "),r("el-form-item",{attrs:{label:"订单总额",prop:"sofa_cover_item_id"}},[r("span",[t._v(t._s(t.order.total))])]),t._v(" "),r("el-form-item",{attrs:{label:"数量",prop:"sofa_cover_item_id"}},[r("span",[t._v(t._s(t.order.count))])]),t._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"note"}},[r("span",[t._v(t._s(t.order.note))])])],1),t._v(" "),r("h5",[t._v("已定制规格列表")]),t._v(" "),r("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},t._l(t.ods,(function(e){return r("el-form-item",{attrs:{label:e.name}},[r("span",[t._v(t._s(e.info))])])})),1)],1),t._v(" "),r("h5",[t._v("定制规格")]),t._v(" "),r("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeIndex,callback:function(e){t.activeIndex=e},expression:"activeIndex"}},t._l(t.designs,(function(e,n){return r("el-tab-pane",{attrs:{label:e.name,design:e,name:"index"+n}},[r("el-form",{ref:"form",refInFor:!0,attrs:{model:t.form,rule:t.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"规格名称"}},[r("span",[t._v(t._s(e.name))])]),t._v(" "),r("el-form-item",{attrs:{label:"示意图"}},[r("el-image",{staticStyle:{width:"500px",height:"500px"},attrs:{src:e.url,fit:"fill"}})],1),t._v(" "),r("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":t.odTabChange},model:{value:t.odIndex,callback:function(e){t.odIndex=e},expression:"odIndex"}},[t._l(t.orderDesigns,(function(t,e){return r("el-tab-pane",{attrs:{label:"方案"+(e+1),od:t,i:e,name:"plan"+t.id}})})),t._v(" "),r("el-tab-pane",{attrs:{label:"新增",name:"add"}})],2),t._v(" "),t._l(e.types,(function(e){return r("el-form-item",{attrs:{label:e}},[t.order.confirmed_at?r("span",[t._v(t._s(t.form.lengths[e]))]):r("el-input",{attrs:{placeholder:"单位：cm"},model:{value:t.form.lengths[e],callback:function(r){t.$set(t.form.lengths,e,r)},expression:"form.lengths[type]"}})],1)})),t._v(" "),r("el-form-item",{attrs:{label:"个数"}},[t.order.confirmed_at?r("span",[t._v(t._s(t.form.count))]):r("el-input",{ref:t.form.count,refInFor:!0,model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"耗用布料"}},[r("span",[t._v(t._s(""+t.form.width*t.form.count))])]),t._v(" "),r("el-form-item",{attrs:{label:"辅料"}},[r("span",[t._v(t._s(""+t.form.accessories))])]),t._v(" "),r("el-form-item",{attrs:{label:"辅料个数"}},[r("span",[t._v(t._s(""+t.form.accessories_count*t.form.count))])]),t._v(" "),r("el-form-item",[t.order.confirmed_at?t._e():r("el-button",{attrs:{loading:t.loading,type:"primary"},nativeOn:{click:function(e){return t.onSubmit(e)}}},[t._v("保存")]),t._v(" "),!t.order.confirmed_at&&t.form.od_id?r("el-button",{attrs:{loading:t.loading,type:"danger"},nativeOn:{click:function(e){return t.onDel(e)}}},[t._v("删除")]):t._e()],1)],2)],1)})),1),t._v(" "),t.order.confirmed_at?r("el-button",{attrs:{type:"primary"}},[r("a",{attrs:{target:"_blank",href:t.order.print}},[t._v("打印")])]):t._e()],1)},o=[],i=(r("7f7f"),r("f8b7")),s={data:function(){return{form:{od_id:"",lengths:{},count:"",width:""},order:{oid:"",recipient_information:"",sofa:{},sofa_item:{},note:"",ods:{},print:""},designs:[{id:0}],activeDesign:{},rules:{lengths:[{required:!0,trigger:"blur",message:"边长必填"}],count:[{required:!0,trigger:"blur",message:"个数必填"}]},loading:!1,activeIndex:"index0",ods:[],orderDesigns:[],odIndex:"add"}},computed:{id:function(){return this.$route.params.id},step:function(){return this.$route.query.step}},mounted:function(){this.freshOrder()},methods:{freshOrder:function(){var t=this;Object(i["e"])(this.id).then((function(e){var r=e.data;t.order=r,t.designs=r.sofa.designs,t.activeDesign&&t.activeDesign=={}||(t.activeDesign=r.sofa.designs[0]),t.freshDesign()}))},handleClick:function(t,e){this.activeDesign=t.$attrs.design,this.freshDesign()},freshDesign:function(){var t=this;Object(i["f"])(this.id,this.activeDesign.id).then((function(e){var r=e.data;t.orderDesigns=r.data,t.ods=r.meta.ods,t.clearForm()}))},onSubmit:function(){for(var t=this,e=0;e<this.activeDesign.types.length;e++){var r=this.activeDesign.types[e];if(!this.form.lengths[r])return this.$message.error("".concat(r,"必须填写"))}if(!(this.form.count>=0))return this.$message.error("个数必须填写");this.loading=!0,Object(i["i"])(this.id,this.activeDesign.id,this.form).then((function(e){t.$message("保存成功"),t.loading=!1,t.freshOrder()})).catch((function(e){console.log(e),t.loading=!1}))},onDel:function(){var t=this;this.loading=!0,Object(i["d"])(this.id,this.activeDesign.id,this.form.od_id).then((function(e){t.loading=!1,t.ods=e.data,t.freshOrder()})).catch((function(e){console.log(e),t.loading=!1}))},odTabChange:function(t){var e=t.$attrs.i;if("add"===t.name)return this.clearForm(),!1;this.form.od_id=t.$attrs.od.id,this.form.lengths=this.orderDesigns[e].lengths,this.form.count=this.orderDesigns[e].count,this.form.width=this.orderDesigns[e].width,this.form.accessories=this.orderDesigns[e].accessories,this.form.accessories_count=this.orderDesigns[e].accessories_count},clearForm:function(){this.form.od_id="",this.form.lengths={},this.form.count="",this.form.width="",this.form.accessories="",this.form.accessories_count="",this.odIndex="add"}}},a=s,c=(r("0f83"),r("2877")),d=Object(c["a"])(a,n,o,!1,null,"0ee27c5d",null);e["default"]=d.exports},f8b7:function(t,e,r){"use strict";r.d(e,"g",(function(){return o})),r.d(e,"e",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"h",(function(){return a})),r.d(e,"c",(function(){return c})),r.d(e,"a",(function(){return d})),r.d(e,"f",(function(){return l})),r.d(e,"i",(function(){return f})),r.d(e,"d",(function(){return u}));var n=r("b775");function o(t){return Object(n["a"])({url:"order?".concat(t),method:"get"})}function i(t){return Object(n["a"])({url:"order/".concat(t),method:"get"})}function s(t){return Object(n["a"])({url:"order",method:"post",data:t})}function a(t,e){return Object(n["a"])({url:"order/".concat(t,"/update"),method:"post",data:e})}function c(t){return Object(n["a"])({url:"order/".concat(t,"/delete"),method:"post"})}function d(t){return Object(n["a"])({url:"order/".concat(t,"/confirm"),method:"post"})}function l(t,e){return Object(n["a"])({url:"order/".concat(t,"/design/").concat(e),method:"get"})}function f(t,e,r){return Object(n["a"])({url:"order/".concat(t,"/design/").concat(e,"/update"),method:"post",data:r})}function u(t,e,r){return Object(n["a"])({url:"order/".concat(t,"/design/").concat(e,"/od/").concat(r,"/delete"),method:"post"})}}}]);