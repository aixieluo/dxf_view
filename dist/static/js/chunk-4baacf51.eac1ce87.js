(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4baacf51"],{bdeb:function(e,t,n){},c04c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[e.step?n("el-steps",{staticStyle:{"margin-bottom":"30px"},attrs:{active:2,"align-center":""}},[n("el-step",{attrs:{title:"已完成"}}),e._v(" "),n("el-step",{attrs:{title:"选择定制规格"}})],1):e._e(),e._v(" "),n("el-collapse",[n("el-collapse-item",{attrs:{title:"订单信息",name:"1"}},[n("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},[n("el-form-item",{attrs:{label:"淘宝订单号",prop:"oid"}},[n("span",[e._v(e._s(e.order.oid))])]),e._v(" "),n("el-form-item",{attrs:{label:"收件人信息",prop:"recipient_information"}},[n("span",[e._v(e._s(e.order.recipient_information))])]),e._v(" "),n("el-form-item",{attrs:{label:"定制类型",prop:"sofa_cover_id"}},[n("span",[e._v(e._s(e.order.sofa.name))])]),e._v(" "),n("el-form-item",{attrs:{label:"材料选择",prop:"sofa_cover_item_id"}},[n("span",[e._v(e._s(e.order.sofa_item.chain_name))])]),e._v(" "),n("el-form-item",{attrs:{label:"备注",prop:"note"}},[n("span",[e._v(e._s(e.order.note))])])],1)],1)],1),e._v(" "),n("div",[n("h5",[e._v("已定制规格列表")]),e._v(" "),n("el-form",{attrs:{"auto-complete":"on","label-width":"120px"}},e._l(e.ods,(function(t){return n("el-form-item",{attrs:{label:t.name}},[n("span",[e._v(e._s(t.info))])])})),1)],1),e._v(" "),n("h5",[e._v("定制规格")]),e._v(" "),n("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},e._l(e.designs,(function(t,r){return n("el-tab-pane",{attrs:{label:t.name,design:t,name:"index"+r}},[n("el-form",{ref:"form",refInFor:!0,attrs:{model:e.form,rule:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"规格名称"}},[n("span",[e._v(e._s(t.name))])]),e._v(" "),n("el-form-item",{attrs:{label:"示意图"}},[n("el-image",{staticStyle:{width:"500px",height:"500px"},attrs:{src:t.url,fit:"fill"}})],1),e._v(" "),n("el-tabs",{attrs:{lazy:!0,type:"card"},on:{"tab-click":e.odTabChange},model:{value:e.odIndex,callback:function(t){e.odIndex=t},expression:"odIndex"}},[e._l(e.orderDesigns,(function(e,t){return n("el-tab-pane",{attrs:{label:"方案"+(t+1),od:e,i:t,name:"plan"+e.id}})})),e._v(" "),n("el-tab-pane",{attrs:{label:"新增",name:"add"}})],2),e._v(" "),e._l(t.types,(function(t){return n("el-form-item",{attrs:{label:t}},[e.order.confirmed_at?n("span",[e._v(e._s(e.form.lengths[t]))]):n("el-input",{attrs:{placeholder:"单位：cm"},model:{value:e.form.lengths[t],callback:function(n){e.$set(e.form.lengths,t,n)},expression:"form.lengths[type]"}})],1)})),e._v(" "),n("el-form-item",{attrs:{label:"个数"}},[e.order.confirmed_at?n("span",[e._v(e._s(e.form.count))]):n("el-input",{ref:e.form.count,refInFor:!0,model:{value:e.form.count,callback:function(t){e.$set(e.form,"count",t)},expression:"form.count"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"耗用布料"}},[n("span",[e._v(e._s(""+e.form.width*e.form.count))])]),e._v(" "),n("el-form-item",{attrs:{label:"辅料"}},[n("span",[e._v(e._s(""+e.form.design.accessories))])]),e._v(" "),n("el-form-item",{attrs:{label:"辅料个数"}},[n("span",[e._v(e._s(""+e.form.design.accessories_count*e.form.count))])]),e._v(" "),n("el-form-item",[e.order.confirmed_at?e._e():n("el-button",{attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return e.onSubmit(t)}}},[e._v("保存")]),e._v(" "),!e.order.confirmed_at&&e.form.od_id?n("el-button",{attrs:{loading:e.loading,type:"danger"},nativeOn:{click:function(t){return e.onDel(t)}}},[e._v("删除")]):e._e()],1)],2)],1)})),1),e._v(" "),e.order.confirmed_at?n("el-button",{attrs:{type:"primary"}},[n("a",{attrs:{target:"_blank",href:e.order.print}},[e._v("打印")])]):e._e()],1)},o=[],i=(n("7f7f"),n("f8b7")),s={data:function(){return{form:{od_id:"",lengths:{},count:"",width:"",design:{accessories:"",accessories_count:0}},order:{oid:"",recipient_information:"",sofa:{},sofa_item:{},note:"",ods:{},print:""},designs:[{id:0}],activeDesign:{},rules:{lengths:[{required:!0,trigger:"blur",message:"边长必填"}],count:[{required:!0,trigger:"blur",message:"个数必填"}]},loading:!1,activeIndex:"index0",ods:[],orderDesigns:[],odIndex:"add"}},computed:{id:function(){return this.$route.params.id},step:function(){return this.$route.query.step}},mounted:function(){var e=this;Object(i["e"])(this.id).then((function(t){var n=t.data;e.order=n,e.designs=n.sofa.designs,e.ods=n.ods,e.activeDesign=n.sofa.designs[0],e.freshDesign()}))},methods:{handleClick:function(e,t){this.activeDesign=e.$attrs.design,this.freshDesign()},freshDesign:function(){var e=this;Object(i["f"])(this.id,this.activeDesign.id).then((function(t){var n=t.data;e.orderDesigns=n.data,e.ods=n.meta.ods,e.clearForm()}))},onSubmit:function(){for(var e=this,t=0;t<this.activeDesign.types.length;t++){var n=this.activeDesign.types[t];if(!this.form.lengths[n])return this.$message.error("".concat(n,"必须填写"))}if(!(this.form.count>=0))return this.$message.error("个数必须填写");this.loading=!0,Object(i["i"])(this.id,this.activeDesign.id,this.form).then((function(t){e.$message("保存成功"),e.loading=!1,e.freshDesign()})).catch((function(t){console.log(t),e.loading=!1}))},onDel:function(){var e=this;this.loading=!0,Object(i["d"])(this.id,this.activeDesign.id,this.form.od_id).then((function(t){e.loading=!1,e.ods=t.data,e.freshDesign()})).catch((function(t){console.log(t),e.loading=!1}))},odTabChange:function(e){var t=e.$attrs.i;if("add"===e.name)return this.clearForm(),!1;this.form.od_id=e.$attrs.od.id,this.form.lengths=this.orderDesigns[t].lengths,this.form.count=this.orderDesigns[t].count,this.form.width=this.orderDesigns[t].width,this.form.design.accessories=this.orderDesigns[t].design?this.orderDesigns[t].design.accessories:"",this.form.design.accessories_count=this.orderDesigns[t].design?this.orderDesigns[t].design.accessories_count:""},clearForm:function(){this.form.od_id="",this.form.lengths={},this.form.count="",this.form.width="",this.form.design.accessories="",this.form.design.accessories_count="",this.odIndex="add"}}},a=s,c=(n("dbfa"),n("2877")),d=Object(c["a"])(a,r,o,!1,null,"e717eac2",null);t["default"]=d.exports},dbfa:function(e,t,n){"use strict";var r=n("bdeb"),o=n.n(r);o.a},f8b7:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"d",(function(){return u}));var r=n("b775");function o(e){return Object(r["a"])({url:"order?".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"order/".concat(e),method:"get"})}function s(e){return Object(r["a"])({url:"order",method:"post",data:e})}function a(e,t){return Object(r["a"])({url:"order/".concat(e,"/update"),method:"post",data:t})}function c(e){return Object(r["a"])({url:"order/".concat(e,"/delete"),method:"post"})}function d(e){return Object(r["a"])({url:"order/".concat(e,"/confirm"),method:"post"})}function l(e,t){return Object(r["a"])({url:"order/".concat(e,"/design/").concat(t),method:"get"})}function f(e,t,n){return Object(r["a"])({url:"order/".concat(e,"/design/").concat(t,"/update"),method:"post",data:n})}function u(e,t,n){return Object(r["a"])({url:"order/".concat(e,"/design/").concat(t,"/od/").concat(n,"/delete"),method:"post"})}}}]);