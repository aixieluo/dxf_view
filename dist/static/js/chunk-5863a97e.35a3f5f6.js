(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5863a97e"],{"0d56":function(t,e,n){"use strict";var a=n("5fd0"),r=n.n(a);r.a},"5fd0":function(t,e,n){},"634a":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",{staticClass:"table-header",attrs:{gutter:20,type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:20}},[n("div",{staticClass:"block"},[n("el-select",{attrs:{placeholder:"产品类型"},model:{value:t.filter.sofa_id,callback:function(e){t.$set(t.filter,"sofa_id",e)},expression:"filter.sofa_id"}},t._l(t.sofas,(function(t,e){return n("el-option",{attrs:{label:t,value:e}})})),1),t._v(" "),n("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.pickDates},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}}),t._v(" "),n("el-input",{staticStyle:{width:"180px"},attrs:{type:"text",placeholder:"订单号或提交人姓名"},model:{value:t.filter.name,callback:function(e){t.$set(t.filter,"name",e)},expression:"filter.name"}}),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.fetchData}},[t._v("搜索")])],1)]),t._v(" "),n("el-col",{attrs:{span:4}},[t.del?n("el-button",{attrs:{type:"primary"}},[n("app-link",{attrs:{to:"/order/create"}},[t._v("创建新订单")])],1):t._e()],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"table-top",attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"","row-class-name":t.rowClass},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"ID",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.id)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"淘宝订单号",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.oid)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"提交人",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.user.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"产品类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.sofa.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"订金总额",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.total))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"数量",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.count))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",prop:"created_at",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-time"}),t._v(" "),n("span",[t._v(t._s(e.row.created_at))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",prop:"updated_at",label:"更新时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-time"}),t._v(" "),n("span",[t._v(t._s(e.row.updated_at))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"定制规格",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"}},[n("app-link",{attrs:{to:"/order/"+e.row.id+"/design/update"}},[t._v("详情")])],1),t._v(" "),n("div",[t._v(t._s(e.row.designs_count<1?"(定制数0)":""))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[!e.row.confirmed_at&&t.del?n("el-button",{attrs:{type:"text"}},[n("app-link",{attrs:{to:"/order/"+e.row.id+"/update"}},[t._v("修改")])],1):t._e(),t._v(" "),e.row.confirmed_at?t._e():n("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"是否确认这笔订单，确认后不可修改"},on:{onConfirm:function(n){return t.confirmOrder(e.row)}}},[n("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("确认")])],1),t._v(" "),e.row.confirmed_at?n("el-button",{attrs:{type:"text"}},[n("a",{attrs:{href:t.baseUrl+"/order/"+e.row.id+"/drawing/download"}},[t._v("下载绘图")])]):t._e(),t._v(" "),t.del?n("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"是否删除这笔订单，删除后不可恢复"},on:{onConfirm:function(n){return t.delOrder(e)}}},[n("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除")])],1):t._e()]}}])})],1),t._v(" "),n("div",{staticStyle:{margin:"20px 0"}},[t.showInfo?n("el-alert",{staticStyle:{"margin-bottom":"20px",width:"600px"},attrs:{title:"绿色的行才可以下载绘图，不是绿色的即使选中了也不会加入到现在的集合里",type:"info","show-icon":""},on:{close:t.closeD}}):t._e(),t._v(" "),n("el-button",{attrs:{type:"primary",disabled:t.pickId.length<1},on:{click:t.downloadZip}},[t._v("下载绘图合集")])],1),t._v(" "),n("el-pagination",{staticClass:"el-pagination__editor pagination",attrs:{"hide-on-single-page":!0,background:"",layout:"sizes, total, prev, pager, next, jumper",total:t.total,"page-size":t.filter.perPage,"page-sizes":[10,15,20],"current-page":t.filter.page},on:{"update:pageSize":function(e){return t.$set(t.filter,"perPage",e)},"update:page-size":function(e){return t.$set(t.filter,"perPage",e)},"update:currentPage":function(e){return t.$set(t.filter,"page",e)},"update:current-page":function(e){return t.$set(t.filter,"page",e)},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)},r=[],o=n("f8b7"),l=n("ed08"),i=n("a6e1"),c=n("5f87"),s={components:{AppLink:i["a"]},data:function(){return{list:null,sofas:[],listLoading:!0,total:1,dates:[],pickId:[],filter:{perPage:10,page:1,u:1,start:"",end:"",sofa_id:"",name:""}}},computed:{del:function(){return Object(c["a"])(["admin","operator","sale"])},baseUrl:function(){return"/api"},showInfo:function(){return!localStorage.getItem("orderDownload")}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;this.listLoading=!0,Object(o["g"])(Object(l["b"])(this.filter)).then((function(e){t.list=e.data.list.data,t.sofas=e.data.sofas,t.total=e.data.list.total,t.filter.page=e.data.list.current_page,t.listLoading=!1}))},handleCurrentChange:function(){this.fetchData()},handleSizeChange:function(){this.fetchData()},confirmOrder:function(t){Object(o["a"])(t.id).then((function(e){t.confirmed_at=e.data.confirmed_at,t.count=e.data.count,t.total=e.data.total}))},delOrder:function(t){var e=this;Object(o["c"])(t.row.id).then((function(n){e.list.splice(t.$index)}))},pickDates:function(t){this.filter.start=t?t[0]:"",this.filter.end=t?t[1]:""},rowClass:function(t){var e=t.row;t.index;if(e.confirmed_at)return"success-row"},handleSelectionChange:function(t){this.pickId=[];for(var e=0;e<t.length;e++)t[e]["confirmed_at"]&&this.pickId.push(t[e]["id"])},downloadZip:function(){for(var t="?",e=0;e<this.pickId.length;e++)t+=e>0?"&ids[]=".concat(this.pickId[e]):"ids[]=".concat(this.pickId[e]);location.href="".concat(this.baseUrl,"/order/drawing/zip/download").concat(t)},closeD:function(){localStorage.setItem("orderDownload",1)}}},d=s,u=(n("0d56"),n("2877")),f=Object(u["a"])(d,a,r,!1,null,"feea44ec",null);e["default"]=f.exports},f8b7:function(t,e,n){"use strict";n.d(e,"g",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return l})),n.d(e,"h",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return u})),n.d(e,"d",(function(){return f}));var a=n("b775");function r(t){return Object(a["a"])({url:"order?".concat(t),method:"get"})}function o(t){return Object(a["a"])({url:"order/".concat(t),method:"get"})}function l(t){return Object(a["a"])({url:"order",method:"post",data:t})}function i(t,e){return Object(a["a"])({url:"order/".concat(t,"/update"),method:"post",data:e})}function c(t){return Object(a["a"])({url:"order/".concat(t,"/delete"),method:"post"})}function s(t){return Object(a["a"])({url:"order/".concat(t,"/confirm"),method:"post"})}function d(t,e){return Object(a["a"])({url:"order/".concat(t,"/design/").concat(e),method:"get"})}function u(t,e,n){return Object(a["a"])({url:"order/".concat(t,"/design/").concat(e,"/update"),method:"post",data:n})}function f(t,e){return Object(a["a"])({url:"order/".concat(t,"/design/").concat(e,"/delete"),method:"post"})}}}]);